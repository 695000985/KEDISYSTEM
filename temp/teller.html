<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>财务查询</title>
    <link rel="icon" href="../images/kd.ico" type="image/x-icon" />
    <link rel="stylesheet" href="../css/H-ui.min.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/iconfont.css">
    <link rel="stylesheet" href="../css/kd.css">
    <link rel="stylesheet" href="../css/layer.css">
    <script src="../script/vue.min.js"></script>
    <script src="../script/jquery-2.1.1.min.js"></script>
    <script src="../script/H-ui.min.js"></script>
    <script src="../script/common.js"></script>
    <script src="../script/kedi.js"></script>
    <script src="../script/loading.js"></script>
    <script src="../DatePicker/WdatePicker.js"></script>
    <script src="../script/layer.js"></script>
    <script src="../script/jquery.pagination.js"></script>
    <style>
        [v-cloak] {
            display: none;
        }


        .tr_bg{background-color: #cccccc;}
        .tr_blue{background-color:	#B0E0E6;}
        .teller_top>div div{margin-right: 15px;}
        .mar_btm10{margin-bottom: 10px;}

        .input_dis{}

        .middle_btn>div:hover{cursor: pointer;}
    </style>
</head>

<body>
    <div id="main" v-cloak class="market_shop" style="">
        <!-- <div class="search_txt" style="display:-webkit-box;">
            <div>
                <p>RetailKEDICard</p>
                <input type="text" id="search_CName" :placeholder="obj_txt.CName">
            </div>
            <div>
                <p>汇总编号(NO):</p>
                <input type="text" id="search_EName" v-model="huizong_num" disabled :placeholder="obj_txt.EName">
            </div>
    
    
            <input type="button" id="" name="" value="SearchSC" class="btn btn-success btn-radius btn-serach" style="height: 30px; margin-right: 10px;"
                @click="search_btn()">
            
            <div>
                <p>Region:</p>
                <input v-model="main_stock_out_num" type="text" id="search_EName" placeholder="">
                <input type="button"  value="..." class="btn btn-success btn-radius btn-serach" style="height: 30px;"
                @click="openRegion_select()">
            </div>
    
            <input type="button" value="SearchRegion" class="btn btn-success btn-radius btn-serach" style="height: 30px;"
                @click="search_region()">
        </div> -->
        
        <div class="teller_top">
            <div class="left">
                <div class="left">
                    <input @click="open_acco_man()" type="button" class="btn" value="财务管理" >
                </div>
                <div class="left">
                    <input type="button" class="btn" value="导入Teller">
                </div>
                <div class="left">
                    <input @click="open_teller_use_query()" type="button" class="btn" value="Teller使用查询">
                </div>
                <div class="left">
                    <input type="button" class="btn" value="Teller提款">
                </div>
                <div class="left">
                    <input type="button" class="btn" value="导出未确认Teller">
                </div>
                <div class="left">
                    <input @click="open_freeze_manage()" type="button" class="btn" value="冻结管理">
                </div>
                <div class="left">
                    <input @click="open_relation_query()" type="button" class="btn" value="关联查询">
                </div>
                <div class="left">
                    <input @click="open_pos_taizhang()" type="button" class="btn" value="POS台账">
                </div>
                <div class="left">
                    <input type="button" class="btn" value="核销及调整台账">
                </div>

                <div class="clear"></div>
            </div>
            <div class="left">


            </div>
            <div class="clear"></div>
        </div>

        <div>
            <!-- 左侧 -->
            <div class="left" style="min-height: 500px; width: 50%;padding: 1%;box-sizing: border-box;">
                
                    
                    <div class="marginbtm_15">
                        
                        <div class="left">
                            <div>
                                <div class="left">
                                    <span>从</span>
                                    <input id="ac_start" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from">
                                </div>
                                <div class="left" style="margin-right: 5px;">
                                    <select name="" v-model="sel_val" id="" style="width: 140px;">
                                        <option :value="index" v-for="(item , index) in ac_query_list">{{item.sel}}</option>
                                    </select>
                                </div>
                                <div class="left"><input v-model="un_confirm" type="checkbox">未确认</div>
                                <div class="clear"></div>
                            </div>
                            <div>
                                <div class="left">
                                    <span>到</span>
                                    <input id="ac_end" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                                </div>
                                <div class="left" style="margin-right: 5px;">
                                    <input type="text" v-model="sel_condition" style="width: 140px;padding-left: 0;">
                                </div>
                                <div class="left"><input type="checkbox" @click="confirm_is(confirm, $event)" v-model="confirm">已确认</div>
                                <div class="clear"></div>
                            </div>
                        </div>
                        <div class="left">
                            备注：<input type="text"><input @click="ac_query()" type="button" value="查询">
                        </div>
                        <div class="clear"></div>
                    </div>
                <fieldset id="" style="">
                    <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">银行上传Teller数据</legend>
                
                    <div style="overflow-x: ;">
                        <div class="left" style="min-height:350px;max-height: 500px;overflow-y: scroll;">
                            <table class="table table-border table-bordered table-bg" style="width: 160%;margin:auto;background-color: rgba(200,200,200,.15);">
                                <thead>
                                    <tr>
                                        <th style="width: 100px;">TellerID</th>
                                        <th style="width: 50px;">确认</th>
                                        <th style="width: 90px;">BANK_NAME</th>
                                        <th style="width: 120px;">EFFECTIVE_DATE</th>
                                        <th style="width: 150px;">MEMO</th>
                                        <th style="width: 70px;">Deposit</th>
                                        <th style="width: 100px;">确认日期</th>

                                        <th style="width: 70px;">专卖店</th>
                                        <th style="width: 80px;">Region</th>
                                        <th style="width: 100px;">用途</th>
                                        <th style="width: 150px;">唯一</th>
                                        <th style="width: 80px;">使用</th>
                                        <th style="width: 100px;">UploadDate</th>
                                        <th style="width: 100px;">LockBeforeConfirm</th>
                                        <th style="width: 80px;">LockReason</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr :class="[s['确认'] == 1?(s['使用']==1?'tr_blue':'tr_bg'):'','']" @click="get_teller_query_item(s.TellerID, s.Deposit, s['专卖店'] ,s.BANK_NAME,s.EFFECTIVE_DATE,s['用途'],s['确认'],s['使用'],index)" v-for="(s,index) in teller_query" v-if='teller_query.length'>
                                        <td>{{s.TellerID}}
                                        </td>
                                        <td> <input type="checkbox" :checked="s['确认'] == 1" >
                                        </td>
                                        <td>{{s.BANK_NAME}}
                                        </td>
                                        <td>{{s.EFFECTIVE_DATE}}
                                        </td>
                                        <td>{{s.MEMO}}</td>
                                        <td>{{s.Deposit}}</td>
                                        <td>{{s["确认日期"]}}</td>
                                        <td>{{s["专卖店"]}}</td>
                                        <td>{{s.Region}}</td>
                                        <td>{{s["用途"]}}</td>
                                        <td>{{s["唯一"]}}</td>
                                        <td>{{s["使用"]}}</td>
                                        <td>{{s.UploadDate}}</td>
                                        <td>{{s.LockBeforeConfirm}}</td>
                                        <td>{{s.LockReason}}</td>
                                        <td>
                                        </td>
                
                                    </tr>
                                    <tr v-if="!teller_query.length">
                                        <td colspan="15">{{no_data}}</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="my_page m-style" style="width: auto;">
        
                            </div>
                        </div>
                        <div class="clear"></div>
                        
                    </div>
                </fieldset>	

                
                <div>
                    <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #ffff00;"></span>->关联</div>
                    <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #cccccc;"></span>->确认</div>
                    <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #B0E0E6;"></span>->使用</div>
                    <div class="left"><input @click="all_sel(is_all, $event)" v-model="is_all" type="checkbox"> 全选</div>
                    <div class="clear"></div>
                </div>


                <div>
                    <div class="left">
                        <div class="mar_btm10">
                            <div class="left"><span style="display: inline-block;text-align: right;width:100px;">期初余额</span><input type="text" disabled v-model="charge.ex_yue" ></div>
                            <div class="left"><span style="display: inline-block;text-align: right;width:100px;">本期支出</span><input type="text" disabled v-model="charge.cur_expenditure" name="" id=""></div>    
                            <div class="clear"></div>    
                        </div>
                        <div>
                            <div class="left"><span style="display: inline-block;text-align: right;width:100px;">本期收入</span><input type="text" disabled v-model="charge.income" ></div>
                            <div class="left"><span style="display: inline-block;text-align: right;width:100px;">期末余额</span><input type="text" disabled v-model="charge.ex_end_yue" name="" id=""></div>    
                            <div class="clear"></div>    
                        </div>
                    </div>
                    <div class="left">
                        <input @click="cal_ex_end()" class="btn btn-primary" type="button" value="计算期末" >
                    </div>
                    <div class="clear"></div>
                </div>


                <fieldset>
                    <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">信息</legend>
                    <div>
                        <div class="left"><span style="display: inline-block;width:80px;text-align: right;">TellerID</span><input type="text" v-model="info.id" disabled name="" id=""></div>
                        <div class="left">确认日期<input id="confirm_date" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from"></div>
                        <div class="clear"></div>
                    </div>
                    <div>
                        <div class="left"><span style="display: inline-block;width:80px;text-align: right;">银行</span> <input type="text" v-model='info.bank_name' disabled name="" id=""></div>
                        <div class="left">
                            <select name="" v-model="shop_type" id="">
                                <option value="0">专卖店</option>
                                <option value="1">经销商</option>
                            </select>
                            <input type="text"  v-model="info.shop_no">{{shop_type == 0?'XXX':(shop_type == 1?'KNXXX':'') }}
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div>
                        <div class="left"><span style="display: inline-block;width:80px;text-align: right;">REGION</span>
                            <select name="" v-model="region_item" id="ac_region">
                                <option :value="s.result" v-for="(s,index) in teller_region_list">{{s.region}}</option>
                            </select>
                        </div>
                        <div class="left" style="margin: 0 20px;"><input v-model="freeze" @click="is_freeze(freeze, $event)" type="checkbox">冻结</div>
                        <div class="left">数额<input type="text" v-model="deposit" disabled></div>
                        <div class="clear"></div>
                    </div>
                    <div>
                            <span style="display: inline-block;width:80px;text-align: right;">备注：</span><input id="beizhu" type="text">
                    </div>
                </fieldset>
                <fieldset>
                    <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">操作</legend>
                    <div>
                        <div class="left"><input @click="confirm_btn()" class="btn btn-success" type="button" value="确认" ></div>
                        <div class="left"><input @click="reverse_confirm_btn()" class="btn btn-error" type="button" value="反确认" ></div>
                        <div class="left"><input @click="lock_no_confirm_btn()" class="btn btn-disabled" type="button" value="锁定未确认" ></div>
                    </div>
                </fieldset>

            </div>
            <!-- 订单详细列表  -->
            

            <div class="middle_btn left" style="width: 3%;padding-top: 7%;margin-right: 1%;">
                <div class="" style="margin-top: 20px;font-size: 18px;border: 1px solid #cccccc;padding: 20px 15px;">
                    <!-- <button class="btn" style="width: 20px;height: 100px;word-wrap: break-word;">关联</button> -->
                    <div @click="guanlian($event)">关&nbsp;<br/>&nbsp;联</div>
                </div>
                <div class="" style="margin-top: 20px;font-size: 18px;border: 1px solid #cccccc;padding: 20px 15px;">
                    <div @click="mid_pos($event)">POS</div>
                    <!-- <input class="btn" value="POS" type="button" > -->
                </div>
                <div class="" style="margin-top: 20px;font-size: 18px;border: 1px solid #cccccc;padding: 20px 15px;">
                    <div>核<br/>销<br/>及<br/>调<br/>整</div>
                    <!-- <input class="btn" value="核销及调整" type="button" > -->
                </div>
                <div class="clear"></div>
            </div>

            <!------ RIGHT ------->
            <div class="left" style="width:45%;">
                    <div class="marginbtm_15">
                        
                        <div class="left">
                            <div>
                                <div class="left">
                                    <span>从</span>
                                    <input id="r_query_start" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from">
                                </div>
                                <div class="left" style="margin-right: 5px;">
                                    <select name="" id="" v-model="r_top_sel" style="width: 140px;">
                                        <option  :value="index" v-for="(item,index) in r_ac_query_list">{{item.sel}}</option>
                                    </select>
                                </div>
                                <div class="left">
                                    <input id="pos_true_query_start" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from">
                                </div>
                                <div class="clear"></div>
                            </div>
                            <div>
                                <div class="left">
                                    <span>到</span>
                                    <input id="r_query_end" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                                </div>
                                <div class="left" style="margin-right: 5px;">
                                    <input id="right_textBox5" type="text" style="width: 140px;padding-left: 0;">
                                </div>
                                <div class="left">
                                    <input id="pos_true_query_end" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from">
                                </div>
                                <div class="clear"></div>
                            </div>
                        </div>
                        <div class="left">
                            <input v-model="r_is_select_pos" @click="r_is_select_pos_top(r_is_select_pos, $event)" type="checkbox">POS <input @click="r_top_query()" type="button" value="查询">
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                    <fieldset id="" style="">
                        <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">手工确认的Teller数据</legend>

                        <div style="">
                            <div class="left" style="min-height:350px;max-height: 500px;overflow-y: scroll;">
                                <table id="r_table" ref="r_manual_list" class="table table-border table-bordered table-bg" style="width: 160%;margin:auto;background-color: rgba(200,200,200,.15);">
                                    <thead>
                                        <tr>
                                            <th style="width: 60px;">关联</th>
                                            <th style="width: 60px;">ID</th>
                                            <th style="width: 50px;">银行</th>
                                            <th style="width: 90px;">取款</th>
                                            <th style="width: 100px;">存款</th>
                                            <th style="width: 150px;">确认日期</th>
                                            <th style="width: 70px;">POS日期</th>
                                            <th style="width: 100px;">业绩所属期</th>
    
                                            <th style="width: 70px;">用途</th>
                                            <th style="width: 80px;">ConfPerson</th>
                                            <th style="width: 70px;">确认</th>
                                            <th style="width: 70px;">使用</th>
                                            <th style="width: 80px;">专卖店</th>
                                            <th style="width: 100px;">Region</th>
                                            <th style="width: 80px;">来源</th>
                                            <th style="width: 80px;">备注</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr :class="[s['确认'] == 1?(s['使用']==1?'tr_blue':'tr_bg'):'','']" @click="bind_r_operation(s)" data-indx=""  v-for="(s,index) in r_manual_teller_query" v-if='r_manual_teller_query.length'>
                                            <td><input @click="is_single_check($event)" :check_index="index" :check_id="s.ID" :check_deposit="s['存款']" :check_zhuanmai="s['专卖店']"  class="user_check" type="checkbox">
                                            </td>
                                            <td>{{s.ID}}
                                            </td>
                                            <td>{{s["银行"]}}
                                            </td>
                                            <td>{{s["取款"]}}
                                            </td>
                                            <td>{{s["存款"]}}</td>
                                            <td>{{s["确认日期"]}}</td>
                                            <td>{{s["POS日期"]}}</td>
                                            <td>{{s["业绩所属期"]}}</td>
                                            <td>{{s["用途"]}}</td>
                                            <td>{{s["ConfPerson"]}}</td>
                                            <td><input type="checkbox" :checked="s['确认'] == 1"></td>
                                            <td><input type="checkbox" :checked="s['使用'] == 1"></td>
                                            <td>{{s["专卖店"]}}</td>
                                            <td>{{s.Region}}</td>
                                            <td>{{s["来源"]}}</td>
                                            <td>{{s["备注"]}}
                                            </td>
                    
                                        </tr>
                                        <tr v-if="!r_manual_teller_query.length">
                                            <td colspan="15">{{no_data}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="my_page m-style" style="width: auto;">
            
                                </div>
                            </div>
                            <div class="clear"></div>
                            
                        </div>
                    </fieldset>
                    <div>
                        <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #cccccc;"></span>->确认</div>
                        <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #B0E0E6;"></span>->使用</div>
                        <div class="left"><input v-model="r_freeze" @click="r_is_freeze(r_freeze, $event)" type="checkbox">冻结</div>
                        <div class="left"><input v-model="r_pos" @click="r_is_pos(r_pos, $event)" type="checkbox">POS</div>
                        <div class="left"><input :disabled="r_pos" id="pos" :value="r_pos==true?'POS':''" type="text"></div>
                        <div class="left"><input @click="r_all_sel(r_is_all, $event)" v-model="r_is_all" type="checkbox"> 全选</div>
                        <div class="clear"></div>
                    </div>

                    <fieldset style="margin-top:15px;">
                        <div>
                            <div class="left">
                                <div class="mar_btm10">
                                    <div class="left"><span style="display: inline-block;text-align: right;width:100px;">期初余额</span><input type="text" disabled v-model="r_charge.ex_yue" ></div>
                                    <div class="left"><span style="display: inline-block;text-align: right;width:100px;">本期支出</span><input type="text" disabled v-model="r_charge.cur_expenditure" name="" id=""></div>    
                                    <div class="clear"></div>    
                                </div>
                                <div>
                                    <div class="left"><span style="display: inline-block;text-align: right;width:100px;">本期收入</span><input type="text" disabled v-model="r_charge.income"  ></div>
                                    <div class="left"><span style="display: inline-block;text-align: right;width:100px;">期末余额</span><input type="text" disabled v-model="r_charge.ex_end_yue" name="" id=""></div>    
                                    <div class="clear"></div>    
                                </div>
                            </div>
                            <div class="left">
                                <input class="btn btn-primary" @click="r_cal_ex_end()" type="button" value="计算期末" >
                            </div>
                            <div class="clear"></div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">信息Info</legend>
                        <div>
                            <div class="left" style="margin: 0 15px;">
                                <div class="mar_btm10">
                                    <span style="display: inline-block;text-align: right;width:100px;">TellerID</span> <input v-model="r_TellerID" type="text">
                                </div>
                                <div class="mar_btm10">
                                    <span style="display: inline-block;text-align: right;width:100px;">关联数额：</span><input type="text">
                                </div>
                                <div class="mar_btm10">
                                    <span style="display: inline-block;text-align: right;width:100px;">银行</span> 
                                        <select name="" v-model="r_bank" id="">
                                            <option :value="item.BANK_NAME" v-for="item in r_top_items" :key="item.id" >{{item.BANK_NAME}}</option>    
                                        </select>
                                </div>
                                <div class="mar_btm10">
                                    <span style="display: inline-block;text-align: right;width:100px;">Deposit数额：</span><input v-model="r_deposit" type="text">
                                </div>
                                <div>
                                    <span style="display: inline-block;text-align: right;width:100px;"> REGION</span> 
                                    <select name="" v-model="r_region" id="">
                                        <option :value="item.region" v-for="item in r_teller_region_list">{{item.region}}</option>        
                                    </select>
                                </div>
                            </div>
                            <div class="left">
                                <div class="mar_btm10">备注: <input id="r_hand_beizhu" style="height:35px;" type="text"></div>
                                <div class="mar_btm10">确认日期:<input id="r_confirm_date" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from"></div>
                                <div class="mar_btm10">
                                    <select name="" v-model="r_shop_type" id="">
                                        <option value="0">专卖店</option>
                                        <option value="1">经销商</option>
                                    </select>
                                    <input type="text" v-model="r_confirm_data.right_shopno">{{r_shop_type == 0? 'XXX' :r_shop_type == 1?'KNXXX':''}}
                                </div>
                                <div>用途：<input id="r_yongtu" type="text" disabled value="临时"></div>
                            </div>
                        </div>        
                    </fieldset>
                    <fieldset>
                        <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">操作Operate</legend>
                        <div>
                            <div class="left"><input @click="r_del()" class="btn btn-success" type="button" value="删除" ></div>
                            <div class="left"><input @click="r_piliang_delete()" class="btn btn-error" style="background: #ff0000;" type="button" value="批量删除" ></div>
                            <div class="left"><input @click="r_confirm()" class="btn btn-disabled" type="button" value="确认" ></div>
                            <div class="left"><input v-model="r_Cash_Last" type="checkbox">扣除现金手续</div>
                            <div class="clear"></div>
                        </div>
                    </fieldset>
                    <div style="display:flex;justify-content:flex-end;">
                        <div>
                                <!-- <input id="upfile" type="file" name="upfile">
                                <button @click=upload_file()>上传文件</button> -->
                            <form action="http://211.149.198.76/index.php?s=desktop/Teller_Recharge/ButtonUploadPos_Click" method="POST" enctype="multipart/form-data" >
                                <input type="hidden" :value="t" name="usertoken">
                                <input id="upfile" type="file" name="upfile">
                                <input type="submit" value="提交">
                            </form>
                            
                        </div><div>批量确认</div><div></div>
                    </div>
            </div>



            <div class="clear"></div>
        </div>
        <div class="shop_list">
            
        </div>
    </div>
        <script>
            
            var user_token = get_cache('usertoken'),
                Vdata_list, //列表VUE
                Vresult;
    	    $(function(){
    	        $('.Wdate').val(get_local_time())
    			// get_region();//获取区域
    			// stock_out_search();//根据汇总编号查询
    			// search_region_g();

                get_teller_region();

                get_tok();
                get_r_top_items();
    	    });
            
            Vdata_list = new Vue({
                el:"#main",
                data:{
                    list_l:[],
                    list:[],
                    teller_query:[],
                    no_data: config_txt.no_data.zn, 
                    obj_txt: splicing_obj(get_page_txt('stock_out')), // 对象拼接
                    huizong_num:'2018555555',
                    ac_query_list:[{'sel':'Deposit'},{'sel':'银行'},{'sel':'专卖店'},{'sel':'备注'}],
                    main_stock_out_num:'',
                    is_all:false,
                    r_is_all:false,
                    r_is_select_pos :false,

                    sel_val:-1,
                    sel_condition:'',
                    confirm:false,
                    un_confirm:false,
                    deposit:'',
                    region_item: 'NONE',
                    shop_type:0,
                    r_shop_type:0,
                    freeze:false,
                    teller_region_list:[],
                    charge:{ex_yue:0, cur_expenditure:'', income:'', ex_end_yue:''},
                    r_charge:{ex_yue:0, cur_expenditure:'', income:'', ex_end_yue:''},
                    info:{id:'',shop_no:'',bank_name:'',textBox4:'',textBox29_S:'',dt1:''},
                    
                    index_list:-1,
                    index_bg_color:'',
                    
                    r_top_items:[],
                    r_top_sel:-1,
                    r_ac_query_list:[{'sel':'Deposit'},{'sel':'银行'},{'sel':'专卖店'},{'sel':'备注'},{'sel':'POS'},{'sel':'非POS'}],
                    r_teller_region_list:[],
                    // 右侧中间两个勾选
                    r_freeze:false,
                    r_pos:false,
                    
                    r_TellerID:'',
                    r_Cash_Last:false,
                    r_bank:'',
                    r_region:'',
                    r_deposit:'',
                    r_manual_teller_query:'',
                    r_confirm_data:{right_shopno:'',checkBox10:'',right_bank:'',right_Region:'',right_confirmation_date:'',right_amount:'',textBox3:'',right_remark:'',right_freeze:''},
                    t:'',

                    mul_tr:[],
                    mul_check:[]
                },
                mounted: function(){
                   
                },
                methods:{
                    check_onchange(){
                        console.log(this)
                    },
                    open_add_stock(){ //打开入库窗口
                        add()
                       open_html("stockIn",'#stock_add','stock_add',function(){
                        Refresh()
                       })
                    },
                    a(){
                        console.log('更新汇总编号');
                    },
                    openRegion_select(){
                        console.log('选择区域');
                        open_html("选择区域",'#region_select','region_select',function(){
    //		                Refresh()
                        },500)
                    },
                    search_region(){
                    },
                    ac_query(){
                        console.log($('#ac_start').val(),$('#ac_end').val(),this.sel_val);
                        ac_query_be($('#ac_start').val(),$('#ac_end').val(),this.sel_val,this.sel_condition,);
                    },

                    confirm_is(arg){
                        if(!arg){
                            this.sel_val = 2;

                        }
                    },

                    all_sel(a){
                        console.log(this.teller_query);
                        if(!a){ 
                            for(var i = 0; i< this.teller_query.length;i++){
                                this.teller_query[i]["确认"] = true;
                            }
                        }
                    },
                    // 中间关联
                    guanlian(){
                        connect()
                        
                    },
                    //中间POS
                    mid_pos(){
                        pos_exe({'left':this.teller_query,'right':this.r_manual_teller_query})

                    },


                    r_all_sel(c){
                        console.log(c);
                        var a = this.$refs.r_manual_list.getElementsByClassName('user_check');
                            this.mul_check = [];
                        if(!c){
                            for(var i = 0; i<a.length; i++){
                                    a[i].checked = true;  
                            }
                        }else{
                            for(var i = 0; i<a.length; i++){
                                    a[i].checked = false;
                                
                            }
                        }
                    },

                    is_single_check(event){
                        console.log(event.target.checked);
                        if(!event.target.checked){
                            this.r_is_all = false;
                        }
                    },

                    get_teller_query_item(TellerID,amount,shop_no,bank_name,EFFECTIVE_DATE,yongtu,queren,is_use,index){
                        console.log(TellerID,index);
                        this.index_list = index;
                        this.info.id         = TellerID;
                        this.deposit         = amount;
                        this.info.shop_no    = shop_no;
                        this.info.bank_name  = bank_name;
                        this.info.textBox4   = queren;
                        this.info.textBox29_S= yongtu;
                        this.info.dt1        = EFFECTIVE_DATE;
                        if(is_use){
                            this.index_bg_color  = 'LIGHTBLUE';
                        }else if(!is_use&&queren){
                            this.index_bg_color  = 'LIGHTGRAY';
                        }
                        

                    },

                    cal_ex_end(){
                        this.charge.ex_end_yue = this.charge.ex_yue + this.charge.income - this.charge.cur_expenditure;
                    },
                    r_cal_ex_end(){
                        this.r_charge.ex_end_yue = this.r_charge.ex_yue + this.r_charge.income - this.r_charge.cur_expenditure;
                    },
                    
                    bind_r_operation(s){
                        console.log(this);       
                        this.r_confirm_data.right_shopno = s["专卖店"];
                        this.r_bank = s["银行"];
                        this.r_region = s["Region"];
                        this.r_deposit = s["存款"];
                        this.r_TellerID = s["ID"]
                    },
                    //右侧确认
                    r_confirm(){
                        fn_r_confirm(this.r_confirm_data.right_shopno,
                                    this.r_shop_type,
                                    this.r_bank,
                                    this.r_region,
                                    $("#r_confirm_date").val(),
                                    123,
                                    $("#r_yongtu").val(),
                                    $("#r_hand_beizhu").val(),
                                    this.r_freeze,
                                    this.r_pos,
                                    $("#pos_true_query_start").val(),
                                    $("#pos").val(),
                                    this.r_TellerID,
                                    this.r_Cash_Last
                                    )

                    },

                    r_is_select_pos_top(a){
                        
                        if(!a){
                            this.r_is_select_pos = true;
                        }else{
                            this.r_is_select_pos = false;
                        }
                        console.log(this.r_is_select_pos);
                    },
                    //中间两个勾选判断
                    r_is_freeze(a){
                        
                        if(!a){
                            this.r_freeze = true;
                        }else{
                            this.r_freeze = false;
                        }
                        console.log(this.r_freeze)
                    },
                    r_is_pos(a){
                        if(!a){
                            this.r_pos = true;
                        }else{
                            this.r_pos = false;
                        }
                        console.log(this.r_pos)
                    },

                    confirm_btn(){
                        fn_confirm_btn(
                            this.info.id ,
                            $('#confirm_date').val(),
                            this.info.bank_name, 
                            this.region_item, 
                            this.shop_type,
                            this.info.shop_no,
                            this.deposit,
                            this.freeze
                            )
                    },
                    reverse_confirm_btn(){
                        fn_reverse_confirm_btn(
                            this.info.id ,              //a
                            $('#confirm_date').val(),   //b
                            this.info.bank_name,        //c
                            this.region_item,           //d
                            this.shop_type,             //e
                            this.info.shop_no,          //f
                            this.deposit,               //g
                            this.info.textBox29_S,//h
                            this.info.textBox4,//确认       //i
                            this.info.dt1                   //j
                        )

                        console.log(this.region_item);
                    },

                    lock_no_confirm_btn(){
                        fn_lock_no_confirm_btn(this.info.id)

                    },

                    is_freeze(a){
                        if(!a){
                            this.freeze = true
                        }else{
                            this.freeze = false
                        }
                        console.log(this.freeze);

                    },


                    r_top_query(){
                        // console.log(this.r_top_sel,$("#r_query_start").val(),$("#r_query_end").val(),);
                        fn_r_top_query($("#r_query_start").val(),$("#r_query_end").val(),this.r_top_sel,$("#right_textBox5").val(),this.r_is_select_pos,$('#pos_true_query_start').val(),$("#pos_true_query_end").val());
                        // console.log(this.$refs.r_manual_list.getElementsByTagName('tr').length);

                    },

                    r_del(){
                        r_delete(
                            this.r_TellerID,
                            $("#r_confirm_date").val(),
                            this.r_bank,
                            this.r_region,
                            this.r_confirm_data.right_shopno,
                            $("#r_yongtu").val(),
                            this.r_deposit
                        )
                    },

                    r_piliang_delete(){
                        var a = this.$refs.r_manual_list.getElementsByClassName('user_check');
                        this.mul_check = [];
                        for(var i = 0; i<a.length; i++){
                                if(a[i].checked){
                                    // console.log(a[i].getAttribute("check_id"));
                                    this.mul_check.push({'ID':a[i].getAttribute("check_id"),'存款':a[i].getAttribute("check_deposit"),'专卖店':a[i].getAttribute("check_zhuanmai")});                                    
                                }
                                
                            // }
                            
                        }
                        piliang_delete(this.mul_check);
                    },



                    open_acco_man(){
                        open_html("AccountManage","#account_manage","account_manage",function(){
                            
                        },500)


                    },
                    open_teller_use_query(){
                        open_html("TellerSearch","#teller_use_query","teller_use_query",function(){
                            
                        },800)
                    },
                    open_freeze_manage(){
                        open_html("FreezeManage","#freeze_manage","freeze_manage",function(){
                            
                        },600)
                    },

                    open_relation_query(){
                        open_html("关联查询RelationSearch","#relation_query","relation_query",function(){
                            
                        },800)
                    },
                    open_pos_taizhang(){
                        open_html("FDPOSInfo","#pos_taizhang","pos_taizhang",function(){
                            
                        },800)

                    },
                    upload_file(){
                        upload_excel()
                    }
                    
                }
            });


            //关联
            function connect(){
                var url = '/index.php?s=desktop/Teller_Recharge/button2_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;

            }
            //中间POS
            function pos_exe(para){
                var url = '/index.php?s=desktop/Teller_Recharge/button4_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                data["data"] = para;
                ajax(url,data,function (ret) {
                    console.log(ret);
                })
            }
            function get_tok(){
                Vdata_list.t = get_cache('usertoken');
            }
            function upload_excel(){
                var ser = window.location.href;
                var user_token = get_cache('usertoken');
                var formData = new FormData();
                var name = $("#upfile").val();
                formData.append("file",$("#upfile")[0].files[0]);
                formData.append("name",name);
                formData.append("usertoken",user_token);
                console.log(formData)
                $.ajax({
                    url : 'http://211.149.198.76/index.php?s=desktop/Teller_Recharge/ButtonUploadPos_Click',
                    type : 'POST',
                    async : false,
                    data : formData,
                    // 告诉jQuery不要去处理发送的数据
                    processData : false,
                    // 告诉jQuery不要去设置Content-Type请求头
                    contentType : false,
                    beforeSend:function(){
                        console.log("正在进行，请稍候");
                    },
                    success : function(responseStr) {
                        if(responseStr=="1"){
                            alert("导入成功");
                        }else{
                            alert("导入失败");
                        }
                    }
                });
            }

            function fn_confirm_btn (a,b,c,d,e,f,g,h) {
                var url = '/index.php?s=desktop/Teller_Recharge/Sconfirm_button9_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]         = user_token;
                data["TellerID"]          = a;
                data["confirmation_date"] = b;
                data["bank"]              = c;
                data["Region"]            = d;
                data["shop_type"]         = e;
                data["shopno"]            = f;
                data["amount"]            = g;
                data["freeze"]            = h;
                console.log(data)
                ajax(url,data,function (ret) {
                    console.log(ret);
                    showErr(ret.errmsg)
                })
            }

            function fn_reverse_confirm_btn(a,b,c,d,e,f,g,h,i,j) {
                var url = '/index.php?s=desktop/Teller_Recharge/button13_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]         = user_token;
                data["TellerID"]          = a;
                data["confirmation_date"] = b;
                data["bank"]              = c;
                data["Region"]            = d;
                data["shop_type"]         = e;
                data["shopno"]            = f;
                data["amount"]            = g;
                data["textBox29_S"]       = h;
                data["textBox4"]          = i;
                data["dt1"]               = j;
                console.log(data)
                ajax(url,data,function (ret) {
                    console.log(ret);
                    showErr(ret.errmsg)
                })
            }

            function fn_lock_no_confirm_btn(a) {
                var url = '/index.php?s=desktop/Teller_Recharge/button26_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]= user_token;
                data["TellerID"] = a;
                data["Memo"]     = $("#beizhu").val();
                ajax(url,data,function (ret) {
                    console.log(ret);
                    if(ret.stat == 1){
                        showErr(ret.data)

                    }else{
                        showErr(ret.errmsg)
                    }
                    
                })
            }

            function ac_query_be(start,end,c,d){
                var url = '/index.php?s=desktop/Teller_Recharge/button2_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                data["From"] = start;
                data["To"]   = end;
                data["comboBLcondition"] = c;
                data["textBox1"] = d;
                ajax(url,data,function (ret) {
                    console.log(ret.data.Get_Teller_Info);
                    // localStorage.setItem('asdada',JSON.stringify(ret.data.Get_Teller_Info)) ;
                    Vdata_list.teller_query = ret.data.Get_Teller_Info;
                    Vdata_list.charge.income = ret.data.input.current_income;
                    Vdata_list.charge.cur_expenditure = ret.data.input.current_expenditures;
                })
            }

            function fn_r_top_query(start,end,c,d,e,f,g){
                var url = '/index.php?s=desktop/Teller_Recharge/button3_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                data["From"] = start;
                data["To"]   = end;
                data["right_comboBox8"] = c;
                data["right_textBox5"] = d;
                data["right_pos"] = e;
                data["right_from1"] = f;
                data["right_to1"] = g;
                ajax(url,data,function (ret) {
                    console.log(ret.data);
                    Vdata_list.r_manual_teller_query = ret.data.Get_Teller_Info;
                    Vdata_list.r_charge.income = ret.data.input.right_current_income;
                    Vdata_list.r_charge.cur_expenditure = ret.data.input.right_current_expenditures;
                })

            }
            
            //右侧确认
            function fn_r_confirm(a,b,c,d,e,f,g,h,i,j,k,l,m,n){
                var url = '/index.php?s=desktop/Teller_Recharge/button12_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                data["right_shopno"] = a;
                data["checkBox10"] = b;
                data["right_bank"] = c;
                data["right_Region"] = d;
                data["right_confirmation_date"] = e;
                data["right_amount"] = f;
                data["textBox3"] = g;
                data["right_remark"] = h;
                data["right_freeze"] = i;
                data["right_pos"] = j;
                data["right_from1"] = k;
                data["textBox27"] = l;
                data["right_TellerID"] = m;
                data["right_Cash_Last"] = n;
                console.log(data);
                ajax(url,data,function (ret) {
                    console.log(ret);
                    if(ret.stat){
                        showErr(ret.data.msg);
                    }
                })

            }
            //右侧删除
            function r_delete(a,b,c,d,e,f,g) {
                var url = '/index.php?s=desktop/Teller_Recharge/button11_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                data["TempTellID"] = a;
                data["right_confirmation_date"] = b;
                data["right_bank"] = c;
                data["right_Region"] = d;
                data["right_shopno"] = e;
                data["right_remark"] = f;
                data["right_amount"] = g;
                ajax(url,data,function (ret) {
                    if(ret.stat){
                        showErr(ret.data.msg);
                    }
                })
            }


            //----- 右侧批量删除 ------
            function piliang_delete(arr){
                var url = '/index.php?s=desktop/Teller_Recharge/button30_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                data["data"] = arr;
                console.log(data)
                ajax(url,data,function (ret) {
                    if(ret.stat){
                        
                        for(var a = 0; a < Vdata_list.r_manual_teller_query.length;a++){
                            for(var b = 0;b< Vdata_list.mul_check.length;b++){
                                // if(Vdata_list.r_manual_teller_query[a]['ID'] == Vdata_list.mul_check[b]['ID']){
                                    // Vdata_list.r_manual_teller_query.slice(a,1);
                                    console.log(Vdata_list.mul_check[b]['ID'])
                                // }
                                
                            }
                        }
                        showErr(ret.data);
                    }else if(ret.stat == 0){
                        showErr(ret.errmsg);
                    }
                })
            }

            function get_teller_region() {
                var url = '/index.php?s=desktop/Teller_Recharge/getRegion';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                ajax(url,data,function (ret) {
                    console.log(ret)
                    Vdata_list.teller_region_list   = ret.data;
                    Vdata_list.r_teller_region_list = ret.data;
                    freeze_manage.region_list = ret.data;
                    // Vdata_list.region_list = ret;
                })
            }


            function get_region(){
                var url = '/index.php?s=desktop/common/GetRegion';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                ajax(url,data,function (ret) {
                    console.log(ret)
                    
                    // Vdata_list.region_list = ret;
                })
            }
            
            function stock_out_search(){
                var url = '/index.php?s=desktop/Stock_Out_Management/SearchScStockOut';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"] = user_token;
                data["NO"]        = '2018109';
                data["Category"]  = 'MaterialSale';
                ajax(url,data,function (e) {
                    console.log()
                    if(e.stat == 1){
                        
                    }else{
                        showErr(e.errmsg, e.errmsg_en, e.errcode)
                    }
                })
            }
            

            function get_r_top_items() {
                var url = '/index.php?s=desktop/Teller_Recharge/getBank';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"] = user_token;
                ajax(url,data,function (e) {

                    if(e.stat == 1){
                        Vdata_list.r_top_items = e.data;
                    }else{
                        showErr(e.errmsg, e.errmsg_en, e.errcode)
                    }
                    
                })
            }

            //-------  top_nav  -------



            setTimeout(function () {
                console.log('settimeout')
            })
            
            new Promise(function(resolve){
                console.log('promise')
            }).then(function () {
                console.log('then')
              })

            console.log('out');
        </script>

</body>


    <div id="account_manage" style="display: none; height: 100px!important;">
        <div class="mar_btm10">
            <div class="left" style="magin-right:10px;"><span style="display: inline-block;width:80px;">账户登录名：</span><input type="text" value="" name="" id=""></div>
            <div class="left"><span style="display: inline-block;width:80px;">账户人姓名：</span><input type="text" name="" id=""></div>
            <div class="clear"></div>
        </div>
        <div class="mar_btm10">
            <div class="left" style="magin-right:10px;"><span style="display: inline-block;width:80px;">所属角色：</span><input type="text" value="" name="" id=""></div>
            <div class="left"><span style="display: inline-block;width:80px;">原始密码：</span><input type="text" name="" id=""></div>
            <div class="clear"></div>
        </div>
        <div class="" style="width: 300px;margin: 0 auto;">
            <div><span style="display: inline-block;width:80px;text-align: right;">原密码：</span><input type="password"></div>
            <div><span style="display: inline-block;width:80px;text-align: right;">新密码：</span><input type="password"></div>
            <div><span style="display: inline-block;width:80px;text-align: right;">确认新密码：</span><input type="password"></div>
        </div>
        <div style="margin-top:10px;text-align: center;"><button class="btn btn-primary">修改密码</button><button class="btn">重写</button></div>
    </div>

    <div id="teller_use_query" style="display:none;">
        <div>
            <span>从</span><input id="" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
            <span>至</span><input id="" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
            专卖店（个人账户）<input type="text" placeholder="kn000000" style="width:80px;" >
            数额<input type="text" style="width:70px;">
            <button class="">搜索已确认Teller</button>
        </div>
        <div>
            <table class="table table-border table-bordered table-bg" style="max-height:400px;width: 160%;margin:auto;background-color: rgba(200,200,200,.15);">
                <thead>
                    <tr>
                        <th style="width: 60px;">关联</th>
                        <th style="width: 60px;">ID</th>
                        <th style="width: 50px;">银行</th>
                        <th style="width: 90px;">取款</th>
                        <th style="width: 100px;">存款</th>
                        <th style="width: 150px;">确认日期</th>
                        <th style="width: 70px;">POS日期</th>

                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="checkbox">
                        </td>
                        <td>
                        </td>
                        <td>
                        </td>
                        <td>
                        </td>
                        <td></td>
                        <td></td>
                        <td></td>
                       

                    </tr>
                    <!-- <tr v-if="">
                        <td colspan="15">no data</td>
                    </tr> -->
                </tbody>
            </table>
        </div>
        <div class="oH">
            <div class="left"><span>专卖店（个人）</span><input type="text"></div>
            <div class="left"><span>当前余额</span><input type="text"></div>
            <div class="right"><button>导出Excel</button></div>
        </div>
    </div>
    <!-- freeze_manage -->
    <div id="freeze_manage" style="display:none;">
        <div>
            <div  class="mar_btm10">
                <div class="left">
                    <span>从</span><input id="freeze_query_start" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                </div>
                <div class="left"><span>专卖店</span><input id="zhuanmai_no" type="text" style="width:80px;"></div>
                <div class="left"><span>Region</span>
                    <select name="" v-model="sel_region" id="">
                        <option :value="item.region" v-for="item in region_list">{{item.region}}</option>
                    </select>
                </div>
                <div class="left"><button @click="freeze_query()" class="btn">查询冻结资金</button></div>
                <div class="clear"></div>
            </div>
            <div class="mar_btm10">
                <div class="left">
                    <span>到</span><input id="freeze_query_end" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                </div>
                <div class="left"><span>数额</span><input id="freeze_amount" type="text" style="width:80px;"></div>
                <div class="left"><span>备注</span><input id="freeze_remark" type="text" style="width:80px;"></div>
                <div class="left"><button @click="no_freeze_query()" class="btn btn-primary">查询未冻结资金</button></div>
                <div class="clear"></div>
            </div>
            <div>
                <table ref="reference_freeze" class="table table-border table-bordered table-bg" style="max-height:400px;width: 130%;margin:auto;background-color: rgba(200,200,200,.15);">
                    <thead>
                        <tr>
                            <th style="width: 60px;">筛选</th>
                            <th style="width: 60px;">Teller编号</th>
                            <th style="width: 50px;">账户</th>
                            <th style="width: 90px;">使用</th>
                            <th style="width: 100px;">日期(Date)</th>
                            <th style="width: 60px;">用途</th>
                            <th style="width: 70px;">备注</th>
                            <th style="width: 60px;">所属区域</th>
                            <th style="width: 60px;">来源</th>
                            <th style="width: 60px;">源ID</th>
                            <th style="width: 60px;">操作人</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="item in table_list">
                            <td><input :teller="item['Teller编号']" :sc="item['账户']" :funds="item['使用']" @click="is_single_check($event)" class="freeze_check" type="checkbox">
                            </td>
                            <td>{{item["Teller编号"]}}
                            </td>
                            <td>{{item["账户"]}}
                            </td>
                            <td>{{item["使用"]}}
                            </td>
                            <td>{{item["日期(Date)"]}}
                            </td>
                            <td>{{item["用途"]}}
                            </td>
                            <td>{{item["备注"]}}
                            </td>
                            <td>{{item["所属区域"]}}
                            </td>
                            <td>{{item["来源"]}}
                            </td>
                            <td>{{item["源ID"]}}
                            </td>
                            <td>{{item["操作人"]}}
                            </td>
                        </tr>
                        <!-- <tr v-if="">
                            <td colspan="15">no data</td>
                        </tr> -->
                    </tbody>
                </table>
            </div>
            <div>
                <div class="left"><input v-model="all_select" @click="freeze_all_select(all_select)" type="checkbox"> <span>全选</span></div>
                <div class="left"><button @click="no_freeze_funds()" class="btn btn-primary">解冻被选资金</button></div>
                <div class="left"><button @click="freeze_funds()" class="btn">冻结被选资金</button></div>
                <div class="clear"></div>
            </div>
        </div>
    </div>
    <!-- freeze_manage -->
    <script>
        var freeze_manage = new Vue({
            el:'#freeze_manage',
            data:{
                sel_region:'',
                region_list:[],
                table_list:[],

                all_select:false,
                mul_select:[]
            },
            methods:{
                //一个未选中  设置全选按钮
                is_single_check(event){
                    console.log(event.target.checked);
                    if(!event.target.checked){
                        this.all_select = false;
                    }
                },
                //全选按钮
                freeze_all_select(is){
                    var a = this.$refs.reference_freeze.getElementsByClassName('freeze_check');
                    if(!is){
                        for(var i = 0; i<a.length; i++){
                                a[i].checked = true;  
                        }
                    }else{
                        for(var i = 0; i<a.length; i++){
                                a[i].checked = false;
                            
                        }
                    }
                },

                freeze_query(){
                    button1_Click(
                        $("#freeze_query_start").val(),
                        $("#freeze_query_end").val(),
                        $("#freeze_amount").val(),
                        $("#zhuanmai_no").val(),
                        this.sel_region

                    );
                    
                },
                no_freeze_query(){
                    button4_Click(
                        $("#freeze_query_start").val(),
                        $("#freeze_query_end").val(),
                        $("#freeze_amount").val(),
                        $("#zhuanmai_no").val(),
                        this.sel_region
                    )
                },
                //冻结被选资金
                freeze_funds(){
                    var a = this.$refs.reference_freeze.getElementsByClassName('freeze_check');
                        this.mul_select = [];
                        for(var i = 0; i<a.length; i++){
                            if(a[i].checked){
                                // console.log(a[i].getAttribute("check_id"));
                                this.mul_select.push({'ID':a[i].getAttribute("teller"),'SC':a[i].getAttribute("sc"),'funds':a[i].getAttribute("funds")});                                    
                            }
                                
                        }
                        console.log(this.mul_select)
                    button3_Click(
                        this.mul_select
                    )

                },
                //解冻被选
                no_freeze_funds(){
                    var a = this.$refs.reference_freeze.getElementsByClassName('freeze_check');
                        this.mul_select = [];
                        for(var i = 0; i<a.length; i++){
                            if(a[i].checked){
                                // console.log(a[i].getAttribute("check_id"));
                                this.mul_select.push({'ID':a[i].getAttribute("teller"),'SC':a[i].getAttribute("sc")});                                    
                            }
                                
                        }
                        console.log(this.mul_select)
                    button2_Click(
                        this.mul_select
                    )
                }
                
            }
        })

        function button1_Click(start,end,amount,no,region){
            var url = '/index.php?s=desktop/Freeze_Manage/button1_Click';
            var user_token = get_cache('usertoken');
            var data = {};
            data["usertoken"] = user_token;
            data["from"] = start;
            data["to"] = end;
            data["amount"] = amount;
            data["shopno"] = no;
            data["region"] = region;

            ajax(url,data,function (ret) {
                if(ret.stat){
                    freeze_manage.table_list = [];
                    freeze_manage.table_list = ret.data;
                }

            })

        }

        function button2_Click(para){
            var url = '/index.php?s=desktop/Freeze_Manage/button2_Click';
            var user_token = get_cache('usertoken');
            var data = {};
            data["usertoken"] = user_token;
            data["data"] = para;
            data["remark"] = $("#freeze_remark").val();
            ajax(url,data,function (ret) {
                if(ret.stat){
                    showErr(ret.data);
                }

            })
        }
        function button3_Click(para) {
            var url = '/index.php?s=desktop/Freeze_Manage/button3_Click';
            var user_token = get_cache('usertoken');
            var data = {};
            data["usertoken"] = user_token;
            data["data"] = para;
            data["remark"] = $("#freeze_remark").val();
            ajax(url,data,function (ret) {
                if(ret.stat){
                    showErr(ret.data);
                }

            })
        }
        function button4_Click(start,end,amount,no,region) {
            var url = '/index.php?s=desktop/Freeze_Manage/button4_Click';
            var user_token = get_cache('usertoken');
            var data = {};
            data["usertoken"] = user_token;
            data["from"] = start;
            data["to"] = end;
            data["amount"] = amount;
            data["shopno"] = no;
            data["region"] = region;

            ajax(url,data,function (ret) {
                console.log()
                if(ret.stat){
                    freeze_manage.table_list = [];
                    freeze_manage.table_list = ret.data;
                }else if(ret.stat == 0){
                    showErr(ret.data);
                }
            })
        }
    </script>
    <!--   关联查询  -->
    <div id="relation_query" style="display: none;">
        <div>
            <div class="left" style="width:85%;">
                <fieldset>
                    <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">条件</legend>
                    <div>
                        <div class="mar_btm10">
                            <div class="left">
                                <select name="" id="">
                                    <option :value="index" v-for="(item,index) in comboBox1" >{{item.name}}</option>
                                </select>
                            </div>
                            <div class="left">
                                <span>从</span><input id="" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                                <span>到</span><input id="" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                                <span>专卖店<input type="text"></span>
                                <input type="checkbox"><span>POS</span>
                            </div>
                            <div class="clear"></div>
                        </div>
                        <div>
                            <div class="left">
                                <select name="" id="">
                                    <option value="">系统TellerID</option>
                                    <option value="">手动TellerID</option>
                                </select>
                            </div>
                            <div class="left">
                                <span> </span><input type="text">
                                <span> </span><select name="" id="">
                                    <option value="" v-for="item in x_list">{{item.name}}</option>
                                </select>
                                <select name="" id="">
                                    <option value="">系统</option>
                                    <option value="">手动</option>
                                </select>
                                <span>数额<input type="text"></span>
                            </div>
                            <div class="clear"></div>
                        </div>
                    </div>
                </fieldset>
            </div>
            <div class="left" style="width:15%;">
                <fieldset>
                    <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">查询</legend>
                    <div>
                        <button class="btn btn-primary">关联项搜索</button>
                    </div>
                </fieldset>

            </div>
        </div>

    </div>
    <script>
        var relation_query = new Vue({
            el:'#relation_query',
            data:{
                comboBox1:[{'name':'有效日期'},{'name':'确认日期'}],
                x_list:[{'name':'ALL'},{'name':'ACCESS'},{'name':'UNION'},{'name':'ZENITH'},{'name':'SKY'},{'name':'KBANK'}]
            },
            methods:{

            }
            
        })
    </script>

    <!-- POS台账 -->

    <div id="pos_taizhang" style="display:none;">
        <div>
            <div>
                <div class="left">
                    <select v-model="comboBox2.default" name="" id="">
                        <option v-for="item in comboBox2.list" :value="item.value">{{item.name}}</option>
                    </select>
                </div>
                <div class="left">
                    <span>从</span>
                    <input id="taizhang_from" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                    <select v-model="comboBox1.default" name="" id="">
                        <option v-for="item in comboBox1.list" :value="item.value" value="">{{item.name}}</option>
                    </select>
                    <input id="textBox1" type="text">
                    <input type="checkbox" :checked='check.system'><span>系统</span>
                    <input type="checkbox" :checked='check.hand'><span>手动</span>
                    <input type="checkbox" :checked='check.mark'><span>标记</span>
                    <button @click="button1_Click_req()" class="btn">搜索</button>
                </div>
                <div class="clear"></div>
            </div>
            <div>
                <div class="left">
                    <span>到</span>
                    <input id="taizhang_to" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                    <span>TellerID</span><input type="text">
                    <button class="btn">上一日期</button>
                    <button class="btn">下一日期</button>
                </div>
                <div class="clear"></div>
            </div>
            <div>
                <table class="table table-border table-bordered table-bg" style="max-height:400px;width: 170%;margin:auto;background-color: rgba(200,200,200,.15);">
                    <thead>
                        <tr>
                            <th style="width: 60px;">选择</th>
                            <th style="width: 60px;">TellerID</th>
                            <th style="width: 50px;">Bank</th>
                            <th style="width: 60px;">shopNo</th>
                            <th style="width: 100px;">EffectDate</th>
                            <th style="width: 150px;">确认日期</th>
                            <th style="width: 70px;">POS日期</th>
                            <th style="width: 60px;">摘要</th>
                            <th style="width: 60px;">借方</th>
                            <th style="width: 60px;">贷方</th>
                            <th style="width: 70px;">GrossAmount</th>
                            <th style="width: 60px;">Surcharge</th>
                            <th style="width: 60px;">NetAmount</th>
                            <th style="width: 60px;">TerminalID</th>
                            <th style="width: 60px;">确认人</th>
                            <th style="width: 60px;">Oper</th>
                            <th style="width: 60px;">CreateDate</th>
                            <th style="width: 60px;">LastEditDate</th>
                            <th style="width: 60px;">Mark</th>
                            <th style="width: 60px;">From</th>
                            <th style="width: 60px;">方向</th>
                            <th style="width: 60px;">PosID</th>


                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="item in button1_Click">
                            <td><input type="checkbox">
                            </td>
                            <td>{{item.TellerID}}
                            </td>
                            <td>{{item.Bank}}
                            </td>
                            <td>{{item.shopNo}}
                            </td>
                            <td>{{item.EffectDate}}</td>
                            <td>{{item.确认日期}}</td>
                            <td>{{item.POS日期}}</td>
                            <td>{{item.摘要}}</td>
                            <td>{{item.借方}}</td>
                            <td>{{item.贷方}}</td>
                            <td>{{item.GrossAmount}}</td>
                            <td>{{item.Surcharge}}</td>
                            <td>{{item.NetAmount}}</td>
                            <td>{{item.TerminalID}}</td>
                            <td>{{item.确认人}}</td>
                            <td>{{item.Oper}}</td>
                            <td>{{item.CreateDate}}</td>
                            <td>{{item.LastEditDate}}</td>
                            <td>{{item.Mark}}</td>
                            <td>{{item.From}}</td>
                            <td>{{item.方向}}</td>
                            <td>{{item.PosID}}</td>
    
                        </tr>
                        <!-- <tr v-if="">
                            <td colspan="15">no data</td>
                        </tr> -->
                    </tbody>
                </table>

            </div>
            <div>
                <div>
                    <div class="">
                        借方总额<input type="text">
                        <span>ID</span><input type="text">
                        <button class="btn">标记</button>
                        <input type="checkbox"><span>全选POS</span>
                        <button class="btn">贷方</button>=<span style="display: inline-block;transform:scale(1.5);">></span>未标记
                        <button class="btn">POS</button>=<span style="display: inline-block;transform:scale(1.5);">></span>未匹配
                    </div>
                    <div class="">
                        贷方总额<input type="text">
                        <span>方向</span><input type="text">
                        <button class="btn">去标记</button>
                        <button>核对选中</button>
                        <button class="btn btn-primary">双方</button>=<span style="display: inline-block;transform:scale(1.5);">></span>已核对
                        <button class="btn btn-primary">POS</button>=<span style="display: inline-block;transform:scale(1.5);">></span>已标记
                    </div>
                </div>

            </div>
        </div>


    </div>
  <!-- POS台账 -->
    <script>
        var pos_taizhang = new Vue({
            el:"#pos_taizhang",
            data:{
                check:{
                    mark:true,
                    system:true,
                    hand:true
                },
                comboBox1:{
                    default:0,
                    list:[{'value':0,'name':'借方'},{'value':1,'name':'贷方'},{'value':2,'name':'Bank'},{'value':3,'name':'确认人'},{'value':4,'name':'摘要'}]
                },
                comboBox2:{
                    default:3,
                    list:[{'value':0,'name':'无日期'},{'value':1,'name':'EffectDate'},{'value':2,'name':'确认日期'},{'value':3,'name':'POS日期'}]
                },
                button1_Click:[]
                
            },
            methods:{
                button1_Click_req(){
                    taizhang_search(
                        this.check.mark,
                        this.check.system,
                        this.check.hand,
                        $("#taizhang_from").val(),
                        $("#taizhang_to").val(),
                        this.comboBox2.default,
                        this.comboBox1.default,
                        $("#textBox1").val()


                    )

                },

            }

        })

        function  taizhang_search(mark,system,hand,from,to,comboBox2,comboBox1,textBox1) {
            console.log('tamia');
            var url = '/index.php?s=desktop/Fd_Pos_Info/button1_Click';
            var user_token = get_cache('usertoken');
            var data = {};
            data["usertoken"] = user_token;
            data["mark"]      = mark;
            data["system"]    = system;
            data["hand"]      = hand;
            data["from"]      = from;
            data["to"]        = to;
            data["comboBox2"] = comboBox2;
            data["comboBox1"] = comboBox1;
            data["textBox1"]  = textBox1;
            console.log(data);
            ajax(url,data,function (e) {
                console.log(e);
                if(e.stat){
                    pos_taizhang.button1_Click = e.data.Search;
                }else if(e.stat == 0){
                    showErr(e.errmsg);
                }
                // console.log()
            })

        }
    </script>

</html>