<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>财务查询</title>
    <link rel="icon" href="../images/kd.ico" type="image/x-icon" />
    <link rel="stylesheet" href="../css/H-ui.min.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/iconfont.css">
    <link rel="stylesheet" href="../css/kd.css">
    <link rel="stylesheet" href="../css/layer.css">
    <script src="../script/vue.min.js"></script>
    <script src="../script/jquery-2.1.1.min.js"></script>
    <script src="../script/H-ui.min.js"></script>
    <script src="../script/common.js"></script>
    <script src="../script/kedi.js"></script>
    <script src="../script/loading.js"></script>
    <script src="../DatePicker/WdatePicker.js"></script>
    <script src="../script/layer.js"></script>
    <script src="../script/jquery.pagination.js"></script>
    <style>
        [v-cloak] {
            display: none;
        }


        .tr_bg{background-color: #cccccc;}
        .tr_blue{background-color:	#B0E0E6;}
        .teller_top>div div{margin-right: 15px;}
        .mar_btm10{margin-bottom: 10px;}
    </style>
</head>

<body>
    <div id="main" v-cloak class="market_shop" style="">
        <!-- <div class="search_txt" style="display:-webkit-box;">
            <div>
                <p>RetailKEDICard</p>
                <input type="text" id="search_CName" :placeholder="obj_txt.CName">
            </div>
            <div>
                <p>汇总编号(NO):</p>
                <input type="text" id="search_EName" v-model="huizong_num" disabled :placeholder="obj_txt.EName">
            </div>
    
    
            <input type="button" id="" name="" value="SearchSC" class="btn btn-success btn-radius btn-serach" style="height: 30px; margin-right: 10px;"
                @click="search_btn()">
            
            <div>
                <p>Region:</p>
                <input v-model="main_stock_out_num" type="text" id="search_EName" placeholder="">
                <input type="button"  value="..." class="btn btn-success btn-radius btn-serach" style="height: 30px;"
                @click="openRegion_select()">
            </div>
    
            <input type="button" value="SearchRegion" class="btn btn-success btn-radius btn-serach" style="height: 30px;"
                @click="search_region()">
        </div> -->
        
        <div class="teller_top">
            <div class="left">
                <div class="left">
                    <input @click="open_acco_man()" type="button" class="btn" value="财务管理" >
                </div>
                <div class="left">
                    <input type="button" class="btn" value="导入Teller">
                </div>
                <div class="left">
                    <input type="button" class="btn" value="Teller使用查询">
                </div>
                <div class="left">
                    <input type="button" class="btn" value="Teller提款">
                </div>
                <div class="left">
                    <input type="button" class="btn" value="导出未确认Teller">
                </div>
                <div class="clear"></div>
            </div>
            <div class="left">


            </div>
            <div class="clear"></div>
        </div>

        <div>
            <div class="left" style="min-height: 500px; width: 50%;padding: 1%;box-sizing: border-box;">
                
                    
                    <div class="marginbtm_15">
                        
                        <div class="left">
                            <div>
                                <div class="left">
                                    <span>从</span>
                                    <input id="ac_start" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from">
                                </div>
                                <div class="left" style="margin-right: 5px;">
                                    <select name="" v-model="sel_val" id="" style="width: 140px;">
                                        <option :value="index" v-for="(item , index) in ac_query_list">{{item.sel}}</option>
                                    </select>
                                </div>
                                <div class="left"><input v-model="un_confirm" type="checkbox">未确认</div>
                                <div class="clear"></div>
                            </div>
                            <div>
                                <div class="left">
                                    <span>到</span>
                                    <input id="ac_end" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                                </div>
                                <div class="left" style="margin-right: 5px;">
                                    <input type="text" v-model="sel_condition" style="width: 140px;padding-left: 0;">
                                </div>
                                <div class="left"><input type="checkbox" @click="confirm_is(confirm, $event)" v-model="confirm">已确认</div>
                                <div class="clear"></div>
                            </div>
                        </div>
                        <div class="left">
                            备注：<input type="text"><input @click="ac_query()" type="button" value="查询">
                        </div>
                        <div class="clear"></div>
                    </div>
                <fieldset id="" style="">
                    <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">银行上传Teller数据</legend>
                
                    <div style="overflow-x: ;">
                        <div class="left" style="min-height:350px;max-height: 500px;overflow-y: scroll;">
                            <table class="table table-border table-bordered table-bg" style="width: 160%;margin:auto;background-color: rgba(200,200,200,.15);">
                                <thead>
                                    <tr>
                                        <th style="width: 100px;">TellerID</th>
                                        <th style="width: 50px;">确认</th>
                                        <th style="width: 90px;">BANK_NAME</th>
                                        <th style="width: 120px;">EFFECTIVE_DATE</th>
                                        <th style="width: 150px;">MEMO</th>
                                        <th style="width: 70px;">Deposit</th>
                                        <th style="width: 100px;">确认日期</th>

                                        <th style="width: 70px;">专卖店</th>
                                        <th style="width: 80px;">Region</th>
                                        <th style="width: 100px;">用途</th>
                                        <th style="width: 150px;">唯一</th>
                                        <th style="width: 80px;">使用</th>
                                        <th style="width: 100px;">UploadDate</th>
                                        <th style="width: 100px;">LockBeforeConfirm</th>
                                        <th style="width: 80px;">LockReason</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr :class="[s['确认'] == 1?(s['使用']==1?'tr_blue':'tr_bg'):'','']" @click="get_teller_query_item(s.TellerID, s.Deposit, s['专卖店'] ,s.BANK_NAME,s.EFFECTIVE_DATE,s['用途'],s['确认'],s['使用'],index)" v-for="(s,index) in teller_query" v-if='teller_query.length'>
                                        <td>{{s.TellerID}}
                                        </td>
                                        <td> <input type="checkbox" :checked="s['确认'] == 1" >
                                        </td>
                                        <td>{{s.BANK_NAME}}
                                        </td>
                                        <td>{{s.EFFECTIVE_DATE}}
                                        </td>
                                        <td>{{s.MEMO}}</td>
                                        <td>{{s.Deposit}}</td>
                                        <td>{{s["确认日期"]}}</td>
                                        <td>{{s["专卖店"]}}</td>
                                        <td>{{s.Region}}</td>
                                        <td>{{s["用途"]}}</td>
                                        <td>{{s["唯一"]}}</td>
                                        <td>{{s["使用"]}}</td>
                                        <td>{{s.UploadDate}}</td>
                                        <td>{{s.LockBeforeConfirm}}</td>
                                        <td>{{s.LockReason}}</td>
                                        <td>
                                        </td>
                
                                    </tr>
                                    <tr v-if="!teller_query.length">
                                        <td colspan="15">{{no_data}}</td>
                                    </tr>
                                </tbody>
                            </table>
                            <div class="my_page m-style" style="width: auto;">
        
                            </div>
                        </div>
                        <div class="clear"></div>
                        
                    </div>
                </fieldset>	

                
                <div>
                    <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #ffff00;"></span>->关联</div>
                    <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #cccccc;"></span>->确认</div>
                    <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #B0E0E6;"></span>->使用</div>
                    <div class="left"><input @click="all_sel(is_all, $event)" v-model="is_all" type="checkbox"> 全选</div>
                    <div class="clear"></div>
                </div>


                <div>
                    <div class="left">
                        <div class="mar_btm10">
                            <div class="left"><span style="display: inline-block;text-align: right;width:100px;">期初余额</span><input type="text" disabled v-model="charge.ex_yue" ></div>
                            <div class="left"><span style="display: inline-block;text-align: right;width:100px;">本期支出</span><input type="text" disabled v-model="charge.cur_expenditure" name="" id=""></div>    
                            <div class="clear"></div>    
                        </div>
                        <div>
                            <div class="left"><span style="display: inline-block;text-align: right;width:100px;">本期收入</span><input type="text" disabled v-model="charge.income" ></div>
                            <div class="left"><span style="display: inline-block;text-align: right;width:100px;">期末余额</span><input type="text" disabled v-model="charge.ex_end_yue" name="" id=""></div>    
                            <div class="clear"></div>    
                        </div>
                    </div>
                    <div class="left">
                        <input @click="cal_ex_end()" class="btn btn-primary" type="button" value="计算期末" >
                    </div>
                    <div class="clear"></div>
                </div>


                <fieldset>
                    <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">信息</legend>
                    <div>
                        <div class="left"><span style="display: inline-block;width:80px;text-align: right;">TellerID</span><input type="text" v-model="info.id" disabled name="" id=""></div>
                        <div class="left">确认日期<input id="confirm_date" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from"></div>
                        <div class="clear"></div>
                    </div>
                    <div>
                        <div class="left"><span style="display: inline-block;width:80px;text-align: right;">银行</span> <input type="text" v-model='info.bank_name' disabled name="" id=""></div>
                        <div class="left">
                            <select name="" v-model="shop_type" id="">
                                <option value="0">专卖店</option>
                                <option value="1">经销商</option>
                            </select>
                            <input type="text"  v-model="info.shop_no">{{shop_type == 0?'XXX':(shop_type == 1?'KNXXX':'') }}
                        </div>
                        <div class="clear"></div>
                    </div>
                    <div>
                        <div class="left"><span style="display: inline-block;width:80px;text-align: right;">REGION</span>
                            <select name="" v-model="region_item" id="ac_region">
                                <option :value="s.result" v-for="(s,index) in teller_region_list">{{s.region}}</option>
                            </select>
                        </div>
                        <div class="left" style="margin: 0 20px;"><input v-model="freeze" @click="is_freeze(freeze, $event)" type="checkbox">冻结</div>
                        <div class="left">数额<input type="text" v-model="deposit" disabled></div>
                        <div class="clear"></div>
                    </div>
                    <div>
                            <span style="display: inline-block;width:80px;text-align: right;">备注：</span><input id="beizhu" type="text">
                    </div>
                </fieldset>
                <fieldset>
                    <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">操作</legend>
                    <div>
                        <div class="left"><input @click="confirm_btn()" class="btn btn-success" type="button" value="确认" ></div>
                        <div class="left"><input @click="reverse_confirm_btn()" class="btn btn-error" type="button" value="反确认" ></div>
                        <div class="left"><input @click="lock_no_confirm_btn()" class="btn btn-disabled" type="button" value="锁定未确认" ></div>
                    </div>
                </fieldset>

            </div>
            <!-- 订单详细列表  -->
            <!-- <div class="left" style="margin-left: 1%; width: 44%;">
                <table class="table table-border table-bordered table-bg" style="width: 95%; background-color: rgba(200,200,200,0); margin: 0 auto; margin-bottom: 10px;">
                    <thead>
                        <tr>
                            <th style="width: 80px;">{{obj_txt.Product_no}}</th>
                            <th style="width: 100px;">PName</th>
                            <th style="width: 70px;">Sale</th>
                            <th style="width: 70px;">StockOut</th>
                            <th style="width: 180px;">BackOrder</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="(item,index) in list" v-if='list.length'>
                            <td>{{item.ProductNO}}
                            </td>
                            <td>{{item.PName}}
                            </td>
                            <td>{{item.Sale}}
                            </td>
                            <td>{{item.StockOut}}
                            </td>
                            <td>
                                <a title="审核" href="javascript:;" class="btn btn-primary size-S radius" style="text-decoration: none;">
                                check
                                <i class="Hui-iconfont Hui-iconfont-yuedu" style="color: rgb(255, 255, 255);"></i></a>
                                <a title="删除" href="javascript:;" class="btn btn-primary size-S radius" style="text-decoration: none;">
                                delete
                                <i class="Hui-iconfont Hui-iconfont-yuedu" style="color: rgb(255, 255, 255);"></i></a>
                            </td>
    
                        </tr>
                        <tr v-if="!list.length">
                            <td colspan="6">{{no_data}}</td>
                        </tr>
                    </tbody>
                </table>
                <div class="my_page m-style">
    
                </div>
                
            </div> -->


            <div class="left" style="width: 3%;padding-top: 7%;margin-right: 1%;">
                <div class="" style="margin-top: 20px;font-size: 18px;border: 1px solid #cccccc;padding: 20px 15px;">
                    <!-- <button class="btn" style="width: 20px;height: 100px;word-wrap: break-word;">关联</button> -->
                    <div>关&nbsp;<br/>&nbsp;联</div>
                </div>
                <div class="" style="margin-top: 20px;font-size: 18px;border: 1px solid #cccccc;padding: 20px 15px;">
                    <div>POS</div>
                    <!-- <input class="btn" value="POS" type="button" > -->
                </div>
                <div class="" style="margin-top: 20px;font-size: 18px;border: 1px solid #cccccc;padding: 20px 15px;">
                    <div>核<br/>销<br/>及<br/>调<br/>整</div>
                    <!-- <input class="btn" value="核销及调整" type="button" > -->
                </div>
                <div class="clear"></div>
            </div>

            <!------ RIGHT ------->
            <div class="left" style="width:45%;">
                    <div class="marginbtm_15">
                        
                        <div class="left">
                            <div>
                                <div class="left">
                                    <span>从</span>
                                    <input id="r_query_start" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from">
                                </div>
                                <div class="left" style="margin-right: 5px;">
                                    <select name="" id="" v-model="r_top_sel" style="width: 140px;">
                                        <option  :value="index" v-for="(item,index) in r_ac_query_list">{{item.sel}}</option>
                                    </select>
                                </div>
                                <div class="left">
                                    <input id="r_query_end" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from">
                                </div>
                                <div class="clear"></div>
                            </div>
                            <div>
                                <div class="left">
                                    <span>到</span>
                                    <input id="" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_to">
                                </div>
                                <div class="left" style="margin-right: 5px;">
                                    <input type="text" style="width: 140px;padding-left: 0;">
                                </div>
                                <div class="left">
                                    <input id="" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from">
                                </div>
                                <div class="clear"></div>
                            </div>
                        </div>
                        <div class="left">
                            <input type="checkbox">POS <input @click="r_top_query()" type="button" value="查询">
                        </div>
                        <div class="clear"></div>
                    </div>
                    
                    <fieldset id="" style="">
                        <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">手工确认的Teller数据</legend>

                        <div style="">
                            <div class="left" style="min-height:350px;max-height: 500px;overflow-y: scroll;">
                                <table ref="r_manual_list" class="table table-border table-bordered table-bg" style="width: 160%;margin:auto;background-color: rgba(200,200,200,.15);">
                                    <thead>
                                        <tr>
                                            <th style="width: 60px;">关联</th>
                                            <th style="width: 60px;">ID</th>
                                            <th style="width: 50px;">银行</th>
                                            <th style="width: 90px;">取款</th>
                                            <th style="width: 100px;">存款</th>
                                            <th style="width: 150px;">确认日期</th>
                                            <th style="width: 70px;">POS日期</th>
                                            <th style="width: 100px;">业绩所属期</th>
    
                                            <th style="width: 70px;">用途</th>
                                            <th style="width: 80px;">ConfPerson</th>
                                            <th style="width: 70px;">确认</th>
                                            <th style="width: 70px;">使用</th>
                                            <th style="width: 80px;">专卖店</th>
                                            <th style="width: 100px;">Region</th>
                                            <th style="width: 80px;">来源</th>
                                            <th style="width: 80px;">备注</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr :class="[s['确认'] == 1?(s['使用']==1?'tr_blue':'tr_bg'):'','']" v-for="(s,index) in r_manual_teller_query" v-if='r_manual_teller_query.length'>
                                            <td><input type="checkbox" :checked="s['关联'] == 1">
                                            </td>
                                            <td>{{s.ID}}
                                            </td>
                                            <td>{{s["银行"]}}
                                            </td>
                                            <td>{{s["取款"]}}
                                            </td>
                                            <td>{{s["存款"]}}</td>
                                            <td>{{s["确认日期"]}}</td>
                                            <td>{{s["POS日期"]}}</td>
                                            <td>{{s["业绩所属期"]}}</td>
                                            <td>{{s["用途"]}}</td>
                                            <td>{{s["ConfPerson"]}}</td>
                                            <td><input type="checkbox" :checked="s['确认'] == 1"></td>
                                            <td><input type="checkbox" :checked="s['使用'] == 1"></td>
                                            <td>{{s["专卖店"]}}</td>
                                            <td>{{s.Region}}</td>
                                            <td>{{s["来源"]}}</td>
                                            <td>{{s["备注"]}}
                                            </td>
                    
                                        </tr>
                                        <tr v-if="!r_manual_teller_query.length">
                                            <td colspan="15">{{no_data}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="my_page m-style" style="width: auto;">
            
                                </div>
                            </div>
                            <div class="clear"></div>
                            
                        </div>
                    </fieldset>

                    <div>
                        <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #cccccc;"></span>->确认</div>
                        <div class="left" style="margin-right: 20px;"><span style="display:inline-block;vertical-align: sub;width: 15px;height: 15px;background: #B0E0E6;"></span>->使用</div>
                        <div class="left"><input type="checkbox">冻结</div>
                        <div class="left"><input type="checkbox">POS</div>
                        <div class="left"><input type="text"></div>
                        <div class="left"><input @click="r_all_sel(r_is_all, $event)" v-model="r_is_all" type="checkbox"> 全选</div>
                        <div class="clear"></div>
                    </div>

                    <fieldset style="margin-top:15px;">
                        <div>
                            <div class="left">
                                <div class="mar_btm10">
                                    <div class="left"><span style="display: inline-block;text-align: right;width:100px;">期初余额</span><input type="text" disabled v-model="r_charge.ex_yue" ></div>
                                    <div class="left"><span style="display: inline-block;text-align: right;width:100px;">本期支出</span><input type="text" disabled v-model="r_charge.cur_expenditure" name="" id=""></div>    
                                    <div class="clear"></div>    
                                </div>
                                <div>
                                    <div class="left"><span style="display: inline-block;text-align: right;width:100px;">本期收入</span><input type="text" disabled v-model="r_charge.income"  ></div>
                                    <div class="left"><span style="display: inline-block;text-align: right;width:100px;">期末余额</span><input type="text" disabled name="" id=""></div>    
                                    <div class="clear"></div>    
                                </div>
                            </div>
                            <div class="left">
                                <input class="btn btn-primary" type="button" value="计算期末" >
                            </div>
                            <div class="clear"></div>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">操作</legend>
                        <div>
                            <div class="left" style="margin: 0 15px;">
                                <div class="mar_btm10">
                                    <span style="display: inline-block;text-align: right;width:100px;">TellerID</span> <input type="text">
                                </div>
                                <div class="mar_btm10">
                                    <span style="display: inline-block;text-align: right;width:100px;">关联数额：</span><input type="text">
                                </div>
                                <div class="mar_btm10">
                                    <span style="display: inline-block;text-align: right;width:100px;">银行</span> <select name="" id="">
                                            <option value="" v-for="item in r_top_items" :key="item.id" >{{item.BANK_NAME}}</option>    
                                        </select>
                                </div>
                                <div class="mar_btm10">
                                    <span style="display: inline-block;text-align: right;width:100px;">Deposit数额：</span><input type="text">
                                </div>
                                <div>
                                    <span style="display: inline-block;text-align: right;width:100px;"> REGION</span> 
                                    <select name="" id="">
                                        <option value="" v-for="item in r_teller_region_list">{{item.region}}</option>        
                                    </select>
                                </div>
                            </div>
                            <div class="left">
                                <div class="mar_btm10">备注: <input style="height:35px;" type="text"></div>
                                <div class="mar_btm10">确认日期:<input id="" onclick="WdatePicker({el:this,dateFmt:'yyyy-MM-dd'})" class="Wdate date_from"></div>
                                <div class="mar_btm10">
                                    <select name="" v-model="r_shop_type" id="">
                                        <option value="0">专卖店</option>
                                        <option value="1">经销商</option>
                                    </select>
                                    <input type="text">{{r_shop_type == 0? 'XXX' :r_shop_type == 1?'KNXXX':''}}
                                </div>
                                <div>用途：<input type="text" disabled value="临时"></div>
                            </div>
                        </div>        
                    </fieldset>
                    <fieldset>
                        <legend style="width: auto;margin-bottom: 5px; border-bottom: none;">操作</legend>
                        <div>
                            <div class="left"><input class="btn btn-success" type="button" value="删除" ></div>
                            <div class="left"><input class="btn btn-error" style="background: #ff0000;" type="button" value="批量删除" ></div>
                            <div class="left"><input class="btn btn-disabled" type="button" value="确认" ></div>
                            <div class="left"><input type="checkbox">扣除现金手续</div>
                            <div class="clear"></div>
                        </div>
                    </fieldset>
                    <div style="display:flex;justify-content:flex-end;">
                        <div>
                                <input id="upfile" type="file" name="file">
                                <button @click=upload_file()>上传文件</button>
                            <!-- <form action="/index.php?s=desktop/Teller_Recharge/ButtonUploadPos_Click" method="POST" enctype="multipart/form-data" >
                                
                                <input type="submit" value="提交">
                            </form> -->
                            
                        </div><div>批量确认</div><div></div>
                    </div>
            </div>



            <div class="clear"></div>
        </div>
        <div class="shop_list">
            
        </div>
    </div>
        <script>
            
            var user_token = get_cache('usertoken'),
                Vdata_list, //列表VUE
                Vresult;
    	    $(function(){
    	        $('.Wdate').val(get_local_time())
    			// get_region();//获取区域
    			// stock_out_search();//根据汇总编号查询
    			// search_region_g();

                get_teller_region();


                get_r_top_items();
    	    });
            
            Vdata_list = new Vue({
                el:"#main",
                data:{
                    list_l:[],
                    list:[],
                    teller_query:[],
                    no_data: config_txt.no_data.zn, 
                    obj_txt: splicing_obj(get_page_txt('stock_out')), // 对象拼接
                    huizong_num:'2018555555',
                    ac_query_list:[{'sel':'Deposit'},{'sel':'银行'},{'sel':'专卖店'},{'sel':'备注'}],
                    main_stock_out_num:'',
                    is_all:false,
                    r_is_all:false,

                    sel_val:'',
                    sel_condition:'',
                    confirm:false,
                    un_confirm:false,
                    deposit:'',
                    region_item: 'NONE',
                    shop_type:0,
                    r_shop_type:0,
                    freeze:false,
                    teller_region_list:[],
                    charge:{ex_yue:0, cur_expenditure:'', income:'', ex_end_yue:''},
                    r_charge:{ex_yue:0, cur_expenditure:'', income:'', ex_end_yue:''},
                    info:{id:'',shop_no:'',bank_name:'',textBox4:'',textBox29_S:'',dt1:''},
                    
                    index_list:-1,
                    index_bg_color:'',

                    r_top_items:[],
                    r_top_sel:0,
                    r_ac_query_list:[{'sel':'Deposit'},{'sel':'银行'},{'sel':'专卖店'},{'sel':'备注'},{'sel':'POS'},{'sel':'非POS'}],
                    r_teller_region_list:[],

                    r_manual_teller_query:''
                },
                mounted: function(){
                   
                },
                methods:{
                    open_add_stock(){ //打开入库窗口
                        add()
                       open_html("stockIn",'#stock_add','stock_add',function(){
                        Refresh()
                       })
                    },
                    a(){
                        console.log('更新汇总编号');
                    },
                    openRegion_select(){
                        console.log('选择区域');
                        open_html("选择区域",'#region_select','region_select',function(){
    //		                Refresh()
                        },500)
                    },
                    search_region(){
                        search_region_g()
                        
                    },
                    ac_query(){
                        console.log($('#ac_start').val(),$('#ac_end').val(),this.sel_val);
                        ac_query_be($('#ac_start').val(),$('#ac_end').val(),this.sel_val,this.sel_condition);
                    },

                    confirm_is(arg){
                        if(!arg){
                            this.sel_val = 2;

                        }
                    },

                    all_sel(a){
                        console.log(this.teller_query);
                        if(!a){ 
                            for(var i = 0; i< this.teller_query.length;i++){
                                this.teller_query[i]["确认"] = true;
                            }
                        }
                    },
                    r_all_sel(a){
                        console.log(a);
                    },

                    get_teller_query_item(TellerID,amount,shop_no,bank_name,EFFECTIVE_DATE,yongtu,queren,is_use,index){
                        console.log(TellerID,index);
                        this.index_list = index;
                        this.info.id         = TellerID;
                        this.deposit         = amount;
                        this.info.shop_no    = shop_no;
                        this.info.bank_name  = bank_name;
                        this.info.textBox4   = queren;
                        this.info.textBox29_S= yongtu;
                        this.info.dt1        = EFFECTIVE_DATE;
                        if(is_use){
                            this.index_bg_color  = 'LIGHTBLUE';
                        }else if(!is_use&&queren){
                            this.index_bg_color  = 'LIGHTGRAY';
                        }
                        

                    },

                    cal_ex_end(){
                        this.charge.ex_end_yue = this.charge.ex_yue + this.charge.income - this.charge.cur_expenditure;
                    },

                    confirm_btn(){
                        fn_confirm_btn(
                            this.info.id ,
                            $('#confirm_date').val(),
                            this.info.bank_name, 
                            this.region_item, 
                            this.shop_type,
                            this.info.shop_no,
                            this.deposit,
                            this.freeze
                            )
                    },
                    reverse_confirm_btn(){
                        fn_reverse_confirm_btn(
                            this.info.id ,              //a
                            $('#confirm_date').val(),   //b
                            this.info.bank_name,        //c
                            this.region_item,           //d
                            this.shop_type,             //e
                            this.info.shop_no,          //f
                            this.deposit,               //g
                            this.info.textBox29_S,//h
                            this.info.textBox4,//确认       //i
                            this.info.dt1                   //j
                        )

                        console.log(this.region_item);
                    },

                    lock_no_confirm_btn(){
                        fn_lock_no_confirm_btn(this.info.id)

                    },

                    is_freeze(a){
                        if(!a){
                            this.freeze = true
                        }else{
                            this.freeze = false
                        }
                        console.log(this.freeze);

                    },


                    r_top_query(){
                        console.log(this.r_top_sel,$("#r_query_start").val(),$("#r_query_end").val(),);
                        fn_r_top_query($("#r_query_start").val(),$("#r_query_end").val());
                        console.log(this.$refs.r_manual_list.getElementsByTagName('tr').length);
                    },



                    open_acco_man(){
                        open_html("AccountManage","#account_manage","account_manage",function(){
                            
                        },500)


                    },

                    upload_file(){
                        upload_excel()
                    }
                    
                }
            });
            function upload_excel(){
                var ser = window.location.href;
                var formData = new FormData();
                var name = $("#upfile").val();
                formData.append("file",$("#upfile")[0].files[0]);
                formData.append("name",name);
                $.ajax({
                    url : ser + '/index.php?s=desktop/Teller_Recharge/ButtonUploadPos_Click',
                    type : 'POST',
                    async : false,
                    data : formData,
                    // 告诉jQuery不要去处理发送的数据
                    processData : false,
                    // 告诉jQuery不要去设置Content-Type请求头
                    contentType : false,
                    beforeSend:function(){
                        console.log("正在进行，请稍候");
                    },
                    success : function(responseStr) {
                        if(responseStr=="01"){
                            alert("导入成功");
                        }else{
                            alert("导入失败");
                        }
                    }
                });
            }

            function fn_confirm_btn (a,b,c,d,e,f,g,h) {
                var url = '/index.php?s=desktop/Teller_Recharge/Sconfirm_button9_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]         = user_token;
                data["TellerID"]          = a;
                data["confirmation_date"] = b;
                data["bank"]              = c;
                data["Region"]            = d;
                data["shop_type"]         = e;
                data["shopno"]            = f;
                data["amount"]            = g;
                data["freeze"]            = h;
                console.log(data)
                ajax(url,data,function (ret) {
                    console.log(ret);
                    showErr(ret.errmsg)
                })
            }

            function fn_reverse_confirm_btn(a,b,c,d,e,f,g,h,i,j) {
                var url = '/index.php?s=desktop/Teller_Recharge/button13_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]         = user_token;
                data["TellerID"]          = a;
                data["confirmation_date"] = b;
                data["bank"]              = c;
                data["Region"]            = d;
                data["shop_type"]         = e;
                data["shopno"]            = f;
                data["amount"]            = g;
                data["textBox29_S"]       = h;
                data["textBox4"]          = i;
                data["dt1"]               = j;
                console.log(data)
                ajax(url,data,function (ret) {
                    console.log(ret);
                    showErr(ret.errmsg)
                })
            }

            function fn_lock_no_confirm_btn(a) {
                var url = '/index.php?s=desktop/Teller_Recharge/button26_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]= user_token;
                data["TellerID"] = a;
                data["Memo"]     = $("#beizhu").val();
                ajax(url,data,function (ret) {
                    console.log(ret);
                    if(ret.stat == 1){
                        showErr(ret.data)

                    }else{
                        showErr(ret.errmsg)
                    }
                    
                })
            }

            function ac_query_be(start,end,c,d){
                var url = '/index.php?s=desktop/Teller_Recharge/button2_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                data["From"] = start;
                data["To"]   = end;
                data["comboBLcondition"] = c;
                data["textBox1"] = d;
                ajax(url,data,function (ret) {
                    console.log(ret.data.Get_Teller_Info);
                    // localStorage.setItem('asdada',JSON.stringify(ret.data.Get_Teller_Info)) ;
                    Vdata_list.teller_query = ret.data.Get_Teller_Info;
                    Vdata_list.charge.income = ret.data.input.current_income;
                    Vdata_list.charge.cur_expenditure = ret.data.input.current_expenditures;
                })
            }

            function fn_r_top_query(start,end){
                var url = '/index.php?s=desktop/Teller_Recharge/button3_Click';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                data["From"] = start;
                data["To"]   = end;
                ajax(url,data,function (ret) {
                    console.log(ret.data);
                    Vdata_list.r_manual_teller_query = ret.data.Get_Teller_Info;
                    Vdata_list.r_charge.income = ret.data.input.right_current_income;
                    Vdata_list.r_charge.cur_expenditure = ret.data.input.right_current_expenditures;
                })

            }

            function get_teller_region() {
                var url = '/index.php?s=desktop/Teller_Recharge/getRegion';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                ajax(url,data,function (ret) {
                    console.log(ret)
                    Vdata_list.teller_region_list   = ret.data;
                    Vdata_list.r_teller_region_list = ret.data;
                    // Vdata_list.region_list = ret;
                })
            }


            function get_region(){
                var url = '/index.php?s=desktop/common/GetRegion';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"]=user_token;
                ajax(url,data,function (ret) {
                    console.log(ret)
                    
                    // Vdata_list.region_list = ret;
                })
            }
            
            function stock_out_search(){
                var url = '/index.php?s=desktop/Stock_Out_Management/SearchScStockOut';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"] = user_token;
                data["NO"]        = '2018109';
                data["Category"]  = 'MaterialSale';
                ajax(url,data,function (e) {
                    console.log()
                    if(e.stat == 1){
                        
                    }else{
                        showErr(e.errmsg, e.errmsg_en, e.errcode)
                    }
                })
            }
            
            function search_region_g(){
                var url = '/index.php?s=desktop/Stock_Out_Management/SearchRegion';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"] = user_token;
                data["NO"]        = '2018109';
                data["Category"]  = 'MaterialSale';
                data["Region"]    = 'ABA20170224024438';
                data["Condition"] = '123';
                ajax(url,data,function (e) {
                    if(e.stat == 1){
                        Vdata_list.list = e.data.LoadRegionStockOutInfo;
                    }else{
                        showErr(e.errmsg, e.errmsg_en, e.errcode)
                    }
                    
                })
            }

            function get_r_top_items() {
                var url = '/index.php?s=desktop/Teller_Recharge/getBank';
                var user_token = get_cache('usertoken');
                var data = {};
                data["usertoken"] = user_token;
                ajax(url,data,function (e) {

                    if(e.stat == 1){
                        Vdata_list.r_top_items = e.data;
                    }else{
                        showErr(e.errmsg, e.errmsg_en, e.errcode)
                    }
                    
                })
            }

            //-------  top_nav  -------



            setTimeout(function () {
                console.log('settimeout')
            })
            
            new Promise(function(resolve){
                console.log('promise')
            }).then(function () {
                console.log('then')
              })

            console.log('out');
        </script>

</body>


    <div id="account_manage" style="display: none; height: 100px!important;">
        <div class="mar_btm10">
            <div class="left" style="magin-right:10px;"><span style="display: inline-block;width:80px;">账户登录名：</span><input type="text" value="" name="" id=""></div>
            <div class="left"><span style="display: inline-block;width:80px;">账户人姓名：</span><input type="text" name="" id=""></div>
            <div class="clear"></div>
        </div>
        <div class="mar_btm10">
            <div class="left" style="magin-right:10px;"><span style="display: inline-block;width:80px;">所属角色：</span><input type="text" value="" name="" id=""></div>
            <div class="left"><span style="display: inline-block;width:80px;">原始密码：</span><input type="text" name="" id=""></div>
            <div class="clear"></div>
        </div>
        <div class="" style="width: 300px;margin: 0 auto;">
            <div><span style="display: inline-block;width:80px;text-align: right;">原密码：</span><input type="password"></div>
            <div><span style="display: inline-block;width:80px;text-align: right;">新密码：</span><input type="password"></div>
            <div><span style="display: inline-block;width:80px;text-align: right;">确认新密码：</span><input type="password"></div>
        </div>
        <div style="margin-top:10px;text-align: center;"><button class="btn btn-primary">修改密码</button><button class="btn">重写</button></div>
    </div>
</html>